<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Video Imagenes</title>

    <!-- Bootstrap Core CSS -->
    <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="../vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

    <!-- DataTables CSS -->
    <link href="../vendor/datatables-plugins/dataTables.bootstrap.css" rel="stylesheet">

    <!-- DataTables Responsive CSS -->
    <link href="../vendor/datatables-responsive/dataTables.responsive.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">Video Imagenes</a>
            </div>
            <!-- /.navbar-header -->


            <!-- /.navbar-top-links -->

            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">

                        <li>
                            <a href="usuarios.html"><i class="fa fa-user fa-fw"></i> Usuarios</a>
                        </li>
                        <li>
                            <a href="cursos.html"><i class="glyphicon glyphicon-education"></i> Cursos</a>
                        </li>


                    </ul>
                </div>
                <!-- /.sidebar-collapse -->
            </div>
            <!-- /.navbar-static-side -->
        </nav>

        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">Usuarios</h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->

            <!-- /.row -->
            <div class="row">
                <div class="col-lg-8">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Usuarios
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered table-hover">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Usario</th>
                                            <th>Opciones</th>

                                        </tr>
                                    </thead>
                                    <tbody id="tbodyUsers">

                                    </tbody>
                                </table>
                            </div>
                            <!-- /.table-responsive -->
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-6 -->

                <!-- /.col-lg-6 -->
            </div>
            <!-- /.row -->

                <!-- /.col-lg-6 -->

                <!-- /.col-lg-6 -->
                <button type="button" name="button" class="btn btn-default" id="modalRegistro"> Nuevo Usuario </button>
            </div>

            <!-- /.row -->

            <!-- /.row -->
        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Nuevo usuario</h4>
      </div>
      <div class="modal-body">
        <div class="input-group">
          <span class="input-group-addon" id="basic-addon1">Nombre</span>
          <input type="text" name="nombre" class="form-control" placeholder="Nombre" aria-describedby="basic-addon1">
        </div>
        <div class="input-group" style="margin-top:5px">
          <span class="input-group-addon" id="basic-addon2">Contraseña</span>
          <input type="text" class="form-control" name="contra" placeholder="Contraseña" aria-describedby="basic-addon2">
        </div>
        <div class="input-group" style="margin-top:5px">
          <span class="input-group-addon" id="basic-addon2">Correo</span>
          <input type="text" class="form-control" name="correo" placeholder="Correo" aria-describedby="basic-addon2">
        </div>
        <div class="input-group" style="margin-top:5px">
          <label><input type='checkbox' name='permiso' value="1"> Admin </label>
        </div>


      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
        <button id="guardarUsuario" type="button" class="btn btn-primary">Guardar</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="myModalVideo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
<div class="modal-dialog" role="document">
<div class="modal-content">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    <h4 class="modal-title" id="myModalLabel">Video Usuario</h4>
  </div>
  <div class="modal-body">
    <div class="row">
      <video id="videoMo" class="col-md-7" src="" autoplay poster="posterimage.jpg" controls>

    </div>

   </video>

  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>

  </div>
</div>
</div>
</div>

<div class="modal fade" id="myModalCurso" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
<div class="modal-dialog" role="document">
<div class="modal-content">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    <h4 class="modal-title" id="myModalLabel">Elegir curso</h4>
  </div>
  <div class="modal-body">
    <div class="row">
      <ul id="ulC">

      </ul>
    </div>

   </video>

  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
    <button type="button" id="botonUCG" class="btn btn-default" data-dismiss="modal" style="background-color:rgb(81, 148, 210)">Guardar</button>

  </div>
</div>
</div>
</div>

    <!-- jQuery -->
    <script src="../vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="../vendor/metisMenu/metisMenu.min.js"></script>

    <!-- DataTables JavaScript -->
    <script src="../vendor/datatables/js/jquery.dataTables.min.js"></script>
    <script src="../vendor/datatables-plugins/dataTables.bootstrap.min.js"></script>
    <script src="../vendor/datatables-responsive/dataTables.responsive.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="../dist/js/sb-admin-2.js"></script>

    <!-- Page-Level Demo Scripts - Tables - Use for reference -->
    <script>
    $(document).ready(function() {
        $('#dataTables-example').DataTable({
            responsive: true
        });
    });

    if(localStorage.getItem("type") != 1) {
      window.location.replace("index.html");
    }
    </script>

    <script>
    $.ajax({
  method: "GET",
  url: "http://138.68.7.40:8050/api/usuario",
  contentType: "application/x-www-form-urlencoded",
  //data: { name: "John", location: "Boston" }
  })
  .done(function( msg ) {
    var xx ="";
    console.log(msg);
    for (var i = 0; i < msg.length; i++) {
      if(msg[i].video){
         xx += "<tr>  <td>"+i+"</td>  <td>"+msg[i].nombre+"</td> <td>  <button class='btn btnv' style='background-color:#801515;color:white' vid='"+msg[i].video+"'>Ver video</button> </td> </tr>"
      }else if(msg[i].prueba){
         xx += "<tr>  <td>"+i+"</td>  <td>"+msg[i].nombre+"</td> <td> <button class='btn btnRed' idbu='"+msg[i]._id+"' idbc='"+msg[i].prueba+"' style='background-color:#f4b558'>Hacer prueba</button>  </td> </tr>"
      }
      else{
        xx += "<tr>  <td>"+i+"</td>  <td>"+msg[i].nombre+"</td> <td> <button class='btn btnC' idbc='"+msg[i]._id+"' style='background-color:#669999'>Agregar curso</button>  </td> </tr>"
      }
    }
    $("#tbodyUsers").append(xx);
    $(".btnRed").on("click", function(){
      var xl = $(this).attr("idbu");
      var yl = $(this).attr("idbc");
      localStorage.setItem("userID", xl);
      localStorage.setItem("cursoID", yl);
      window.location.replace("http://localhost/PPAbril/pages/carro.html");
    })
    $(".btnv").on("click", function(){
        var x = $(this).attr("vid");
        var y = "http://138.68.7.40:8050/static/"+x;
        $("#videoMo").attr("src", y);
        $("#myModalVideo").modal("show");
        $('#myModalVideo').on('hidden.bs.modal', function (e) {
                 $("#videoMo").attr("src", "");
             })

    });

    $(".btnC").on("click", function(){
      var idU = $(this).attr("idbc");
      $("#ulC").html("");
      $.ajax({
    method: "GET",
    url: "http://138.68.7.40:8050/api/curso",
    contentType: "application/x-www-form-urlencoded",
   })
    .done(function( msg ) {
      var xx ="";
      console.log(msg);
      for (var i = 0; i < msg.length; i++) {
        xx += "<li><label><input type='checkbox' name='opcCheck' value='"+msg[i]._id+"'>"+msg[i].nombre+"</label></li>";

      }
      $("#ulC").append(xx);
      $("#myModalCurso").modal("show");
      var yyy= "";

      $( "input[name=opcCheck]" ).on( "click", function(){
         console.log($( "input:checked" ).attr("value"))
         yyy = $( "input:checked" ).attr("value");
      } );
      $("#botonUCG").on("click", function(){
        console.log("idc"+yyy);
        console.log("idu"+idU);
        $.ajax({
      method: "POST",
      url: "http://138.68.7.40:8050/api/usuarioCurso/"+idU,
      contentType: "application/x-www-form-urlencoded",
      data: {
        "curso": yyy
       }
     })
      .done(function( msg ) {
         location.reload();
      })

      })

    });

    })
  });
    </script>

    <script type="text/javascript">
    $("#modalRegistro").on("click", function(){
          $("#myModal").modal("show");
    })

    </script>

    <script type="text/javascript">
    $("#guardarUsuario").on("click", function(){
      var x = $("input[name=nombre]").val();
      var y = $("input[name=contra]").val();
      var z = $("input[name=correo]").val();

      console.log(x);
      console.log(y);
      var q = 0;
      if($("input[name=permiso]:checked").val() == 1){
         q = 1;
      }else{
        q = 0;
      }

      $.ajax({
    method: "POST",
    url: "http://138.68.7.40:8050/api/usuario",
    contentType: "application/x-www-form-urlencoded",
    dataType : "json",
    data: { nombre: x, pass: y, correo: z, tipo: q }
    })
    .done(function( msg ) {
      $("#myModal").modal("hide");
      location.reload();
    });
    })
    </script>

</body>

</html>
